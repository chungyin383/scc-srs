-- ---------------------------------------------------------------------------------------------------------------------
-- Remove duplicate
-- ---------------------------------------------------------------------------------------------------------------------
DROP TABLE IF EXISTS reg_no_unique;
CREATE TABLE reg_no_unique AS
	SELECT 
		regno, 
		chname, 
		enname,
		sex
	FROM student_raw 
	GROUP BY regno;

-- ---------------------------------------------------------------------------------------------------------------------
-- Upsert reg_no
-- ---------------------------------------------------------------------------------------------------------------------
INSERT INTO reg_no
	SELECT
		regno,
		chname,
	    enname,
	    sex
  	FROM reg_no_unique
	WHERE regno NOT IN (SELECT regno FROM reg_no);

-- ---------------------------------------------------------------------------------------------------------------------
-- Drop temp tables
-- ---------------------------------------------------------------------------------------------------------------------
DROP TABLE IF EXISTS reg_no_unique;